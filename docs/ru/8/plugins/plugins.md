---
id: plugins
title: Плагины
core: 8
metatags:
  title: 'Drupal 8: Плагины (Plugins)'
  description: 'Плагины позволяют добавлять новый функционал на сайт.'
---

**Плагины** — небольшие кусочки бизнес-логики.

**Тип плагина** — плагины, выполняющие один и тот же функционал.

В Drupal 8 находится много плагинов, и типов плагинов по умолчанию. Например, "Блок" (`@Block`) - это тип плагина, а каждый уникальный объект, реализующий данный тип плагина и предоставляющий данные — плагин.

Плагины объявляются и используются в {модулях}(modules:8). Разработчики также могут создавать свои собственные типы плагинов и использовать плагины для своих нужд.

Систему плагинов можно разделить на несколько фундаментальных элементов:

1. <abbr title="Типы плагинов">**Plugin Types**</abbr> — централизванное место, объявляющая как плагины данного типа будут обнаруживаться и использоваться.
1. <abbr title="Исследователь плагинов">**Plugin Discovery**</abbr> — процесс, который используется менеджером плагинов для того чтобы найти плагины конкретного типа, объявленных во всех модулях. Плагины могут объявляться несколькоими способами:
   - <abbr title="Аннотация — специально отформатированный PHP комментарий.">**Annotation**</abbr>: Данный плагины являются объектами, в комментариях класса которого находится аннотация, описывающая параметры для коркетного типа плагина. Это основной способ определения и поиска плагинов, как и самый распространенный для создания собственных типов.
   - {**Хуки**}(hooks:8): Плагины, объявленные через хуки.
   - **YAML**: Плагины, описанные в YAML файлах. Ядро Drupal использует данный способ для обнаружения ссылок local tasks (вкладки) и local action (кнопки действий на страницах). Данный способ очень полезен для тех типов плагинов, где используется один общий класс.
   - <abbr title="Статический">**Static**</abbr>: Плагины являются объектами, но регистрируются менеджером плагинов. Это полезно, если вы хотите запретить создание плагинов данного типа (используется статичный список плагинов в коде).
1. <abbr title="Фабрика плагинов">**Plugin Factory**</abbr> — отвечает за определенных плагинов для конкретного использования.

## Плагины или сервисы?

Плагины и {сервисы}(services:8) очень похожи друг на друга, и могут решать одну и ту же задачу, стоит различать, когда подойдет сервис, а когда плагин.

### Плагины и <abbr title="Tagged services">сервисы с метками</abbr>

Возьмем для примера <abbr title="Breadcrumb Manager">менеджеры хлебных крошек</abbr>, которые являются сервисами с меткой, а также тип плагина "Блок".

Фундаментальная задача у них схожая — дать разработчику возможность описать своё поведение в контексте задачи. Оба варианта описывают бизнес логику в PHP объекте, и их результат затем используется с определенной целью. Но у них есть одно принципиальное отличие — менеджер хлебных крошек никак не взаимодействует с пользователем. Он просто подготаваливает данные для построения хлебных крошек, и участие пользователя не имеет значения и не влияет на результат его работы. Блок же, с другой стороны, тоже генерирует какой-то результат, но имеет возможность дать пользователю повлиять на него. Типы плагинов "Блок" могут предоставлять пользовательский интерфейс с настройками, которые могут быть учтены плагином в дальнейшем. Например, у блоков меню, объявленных через плагины, вы можете выбирать максимальный уровень вложенности выводимого меню.

Используйте плагины, если у пользователя есть возможность (даже опциональная) влиять на работу, в остальных случаях, когда взаимодействие не требуется - используйте сервисы с метками.

## Ссылки

- [Plugin API](https://www.drupal.org/docs/8/api/plugin-api) (англ)
- [Drupal 8: Plugin API — создание собственных типов плагинов](https://niklan.net/blog/134), Niklan, 2016.
