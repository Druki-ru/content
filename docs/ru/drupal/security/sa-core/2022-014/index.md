---
title: SA-CORE-2022-014
slug: wiki/security/sa-core-2022-014
metatags:
  title: 'Drupal: SA-CORE-2022-014'
  description: 'Умеренно критично. Исправлено в версиях: 9.4.3, 9.3.19.'
authors:
  - Niklan
---

**Проект:** Drupal Core\
**Дата публикации:** 20 июля 2022\
**Риск безопасности:** Критично 15∕25. AC:Basic/A:Admin/CI:All/II:All/E:Theoretical/TD:Uncommon\
**Уязвимость:** Произвольное выполнение PHP кода

## Описание

<Aside type="note">

Данная проблема представлена только при использовании веб-сервера Apache.

</Aside>

Drupal ядро занимается санитизацией имён файлов с опасными расширениями в
процессе загрузки и удаляет стартовые и конечные точки из названия файла, для
предотвращения загрузки конфигурационных файлов.

Однако, до этого момента, эти защиты работали по отдельности, а не совместно.
Из-за этого, сайты, где разрешено загружать файлы с расширением `htaccess`,
обрабатывали загрузку некорректно. Это могло привести к проблеме перезаписи
оригинального `.htaccess` и выполнению стороннего кода через Apache.

Эта проблема ослабляется тем, что требуется администратор сайта должен явно
разрешить загрузку `htaccess` (расширение) файлов, или это должен делать
сторонний или собственный модуль.

[Drupal Steward](https://www.drupal.org/steward) не покрывает данную проблему.

## Решение

Обновиться до актуальных версий:

- Если используете Drupal 9.4, обновитесь до Drupal [9.4.3](../../../releases/9/9.4.x/9.4.3/index.md).
- Если используете Drupal 9.3, обновитесь до Drupal [9.3.19](../../../releases/9/9.3.x/9.3.19/index.md).

## Ссылки

- [SA-CORE-2022-014](https://www.drupal.org/SA-CORE-2022-014) (англ.), drupal.org, 20 июля 2022